# 共同開発ガイドライン

このドキュメントは、本プロジェクトで複数人が共同開発を行う際のルールを定めています。

## Git ワークフロー

### 1. 作業開始前に必ず最新を取得

```bash
git pull origin main
```

他のメンバーの変更を取り込んでから作業を開始してください。

### 2. ブランチ戦略

#### mainブランチ
- 本番環境にデプロイされるブランチ
- 直接コミットは**原則禁止**（小さな修正は例外）
- PRをマージする形で更新

#### 機能ブランチ
新機能開発時はブランチを作成：

```bash
git checkout -b feature/機能名
# 例: git checkout -b feature/add-share-button
```

#### 命名規則
| プレフィックス | 用途 |
|--------------|------|
| `feature/` | 新機能追加 |
| `fix/` | バグ修正 |
| `refactor/` | リファクタリング |
| `docs/` | ドキュメント更新 |
| `test/` | テスト追加・修正 |

### 3. コミットメッセージ

#### 形式
```
<種類>: <変更内容の要約>

<詳細な説明（任意）>
```

#### 種類
- `feat`: 新機能
- `fix`: バグ修正
- `docs`: ドキュメントのみの変更
- `style`: コードの意味に影響しない変更（空白、フォーマット等）
- `refactor`: バグ修正や機能追加を伴わないコード変更
- `test`: テストの追加・修正
- `chore`: ビルドプロセスやツールの変更

#### 例
```
feat: SNSシェア機能を追加

- X(Twitter)シェアボタンを実装
- LINEシェアボタンを実装
- URLコピー機能を実装
```

### 4. プルリクエスト（PR）

#### PR作成時のチェックリスト
- [ ] `npm run build` が成功する
- [ ] `npm run test:run` が成功する
- [ ] `npm run lint` でエラーがない
- [ ] 変更内容の説明を記載

#### PRテンプレート
```markdown
## 概要
この変更で何を実現するか

## 変更内容
- 変更点1
- 変更点2

## テスト方法
動作確認の手順

## スクリーンショット（UIの変更がある場合）
```

### 5. コンフリクト解決

コンフリクトが発生した場合：

```bash
# 最新のmainを取得
git fetch origin main

# 現在のブランチにマージ
git merge origin/main

# コンフリクトを解決後
git add .
git commit -m "merge: mainブランチとのコンフリクトを解決"
```

## コーディング規約

### TypeScript
- 型定義を省略しない
- `any`の使用は極力避ける
- 関数には適切な戻り値の型を指定

### React/Next.js
- コンポーネントは関数コンポーネントで記述
- hooksのルールを遵守
- クライアントコンポーネントには`'use client'`を明記

### スタイリング
- Tailwind CSSを使用
- カスタムCSSは最小限に
- レスポンシブ対応を忘れずに

## テスト

### テスト実行
```bash
# ウォッチモード
npm run test

# 1回実行
npm run test:run
```

### テストを書くタイミング
- 新しいユーティリティ関数を追加したとき
- バグを修正したとき（再発防止のため）
- 複雑なロジックを実装したとき

## セキュリティ

### 絶対にコミットしてはいけないもの
- `.env.local`（環境変数）
- APIキー・シークレット
- 個人情報を含むデータ

### 定期的に確認すること
```bash
# 脆弱性チェック
npm audit

# 修正が必要な場合
npm audit fix
```

## デプロイ

### 自動デプロイ
- `main`ブランチにマージされると自動的にVercelにデプロイ
- PRを作成するとプレビューデプロイが生成される

### デプロイ前の確認
1. ローカルでビルドが通ることを確認
2. テストが全て通ることを確認
3. 実際の動作をローカルで確認

## 困ったときは

### よくある問題

#### `npm install`でエラーが出る
```bash
rm -rf node_modules package-lock.json
npm install
```

#### TypeScriptのエラーが消えない
```bash
npm run type-check
```

#### テストが失敗する
```bash
# 詳細なログを確認
npm run test:run -- --reporter=verbose
```

## 連絡方法

- 大きな変更を行う前は事前に相談
- 緊急の問題はすぐに報告
- 不明点があれば質問
